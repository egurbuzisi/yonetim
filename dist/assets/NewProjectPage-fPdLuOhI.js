import{a as e,u as l,j as s,b as t}from"./index-CXP7xW6B.js";import{u as a,r}from"./react-vendor-DBkS_7n-.js";import{Y as n}from"./mahalleler-C9ogN-IT.js";import{O as i,_ as o,s as d,B as c,X as u,W as x,Y as m}from"./icons-uH062rYu.js";function b(){const b=a(),{addProject:h}=e(),{user:p}=l(),[f,j]=r.useState(""),[g,v]=r.useState(""),[N,k]=r.useState("beklemede"),[y,w]=r.useState(""),[C,S]=r.useState(""),[B,P]=r.useState(""),[D,F]=r.useState(""),[z,Y]=r.useState(""),[A,K]=r.useState(""),[M,R]=r.useState([]),[T,E]=r.useState(["1","2"]),[G,I]=r.useState(!1),L=r.useRef(null),O=r.useRef(null),U=e=>{const l=e.target.files?.[0];if(l){const e=new FileReader;e.onload=e=>{const l=document.createElement("img");l.onload=()=>{const e=document.createElement("canvas"),s=800;let t=l.width,a=l.height;t>a?t>s&&(a*=s/t,t=s):a>s&&(t*=s/a,a=s),e.width=t,e.height=a;const r=e.getContext("2d");r?.drawImage(l,0,0,t,a);const n=e.toDataURL("image/jpeg",.7);R(e=>[...e,n])},l.src=e.target?.result},e.readAsDataURL(l)}e.target.value=""},_=e=>{e.preventDefault(),f.trim()?(h({title:f.trim(),description:g.trim(),status:N,createdBy:p?.id||"",targetDate:y?new Date(y):void 0,budget:C?parseFloat(C):void 0,responsible:B||void 0,mahalle:D||void 0,parsel:z||void 0,firma:A||void 0,visibleTo:T}),localStorage.setItem("activeTab","1"),b("/")):alert("Proje adı gerekli!")};return s.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[s.jsxs("header",{className:"flex-shrink-0 bg-blue-900 text-white px-4 py-3 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>b(-1),className:"p-2 hover:bg-blue-800 rounded-lg",children:s.jsx(i,{className:"w-6 h-6"})}),s.jsx("h1",{className:"font-semibold text-lg",children:"Yeni Proje"}),s.jsx("button",{onClick:_,className:"p-2 hover:bg-blue-800 rounded-lg",children:s.jsx(o,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:_,className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Proje Adı *"}),s.jsx("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Proje adını girin...",className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Açıklama"}),s.jsx("textarea",{value:g,onChange:e=>v(e.target.value),placeholder:"Proje açıklaması...",rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[s.jsx(d,{className:"w-4 h-4 inline mr-1"}),"Mahalle"]}),s.jsxs("select",{value:D,onChange:e=>F(e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[s.jsx("option",{value:"",children:"Mahalle Seçin..."}),n.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Ada / Parsel"}),s.jsx("input",{type:"text",value:z,onChange:e=>Y(e.target.value),placeholder:"Örn: 1234 Ada / 56 Parsel",className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[s.jsx(c,{className:"w-4 h-4 inline mr-1"}),"İşi Yapan Firma"]}),s.jsx("input",{type:"text",value:A,onChange:e=>K(e.target.value),placeholder:"Firma adı...",className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Fotoğraflar"}),s.jsx("input",{ref:L,type:"file",accept:"image/*",onChange:U,className:"hidden"}),s.jsx("input",{ref:O,type:"file",accept:"image/*",capture:"environment",onChange:U,className:"hidden"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.map((e,l)=>s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:e,alt:`Fotoğraf ${l+1}`,className:"w-20 h-20 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>(e=>{R(l=>l.filter((l,s)=>s!==e))})(l),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center",children:s.jsx(u,{className:"w-4 h-4"})})]},l)),s.jsxs("button",{type:"button",onClick:()=>O.current?.click(),className:"w-20 h-20 border-2 border-dashed border-slate-300 rounded-lg flex flex-col items-center justify-center text-slate-400 hover:border-blue-500 hover:text-blue-500 transition-colors",children:[s.jsx(x,{className:"w-6 h-6"}),s.jsx("span",{className:"text-xs mt-1",children:"Çek"})]}),s.jsxs("button",{type:"button",onClick:()=>L.current?.click(),className:"w-20 h-20 border-2 border-dashed border-slate-300 rounded-lg flex flex-col items-center justify-center text-slate-400 hover:border-blue-500 hover:text-blue-500 transition-colors",children:[s.jsx(m,{className:"w-6 h-6"}),s.jsx("span",{className:"text-xs mt-1",children:"Galeri"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Durum"}),s.jsxs("select",{value:N,onChange:e=>k(e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[s.jsx("option",{value:"beklemede",children:"Beklemede"}),s.jsx("option",{value:"devam_ediyor",children:"Devam Ediyor"}),s.jsx("option",{value:"tamamlandi",children:"Tamamlandı"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Hedef Bitiş Tarihi"}),s.jsx("input",{type:"date",value:y,onChange:e=>w(e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Bütçe (₺)"}),s.jsx("input",{type:"number",value:C,onChange:e=>S(e.target.value),placeholder:"0",className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Sorumlu Kişi"}),s.jsx("input",{type:"text",value:B,onChange:e=>P(e.target.value),placeholder:"Sorumlu kişi adı...",className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Kimler Görebilsin?"}),s.jsxs("button",{type:"button",onClick:()=>I(!0),className:"w-full px-4 py-3 border border-slate-300 rounded-xl text-left flex items-center justify-between hover:bg-slate-50",children:[s.jsxs("span",{className:"text-slate-600",children:[T.length," kişi seçili"]}),s.jsx("span",{className:"text-blue-600 text-sm",children:"Düzenle"})]}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Sadece seçilen kişiler ve oluşturan görebilir"})]}),s.jsx("button",{type:"submit",className:"w-full py-4 bg-blue-900 text-white font-semibold rounded-xl hover:bg-blue-800 transition-colors mt-6",children:"Proje Oluştur"})]}),G&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>I(!1)}),s.jsxs("div",{className:"fixed inset-x-4 top-1/2 -translate-y-1/2 bg-white rounded-2xl z-50 max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b flex-shrink-0",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Kimler Görebilsin?"}),s.jsxs("p",{className:"text-sm text-slate-500",children:[T.length," kişi seçili"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Başkan"}),t.filter(e=>"Başkan"===e.role).map(e=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:T.includes(e.id),onChange:l=>{l.target.checked?E(l=>[...l,e.id]):E(l=>l.filter(l=>l!==e.id))},className:"w-5 h-5 rounded text-blue-600"}),s.jsx("span",{className:"text-slate-700",children:e.name})]},e.id))]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Özel Kalem"}),t.filter(e=>"Özel Kalem Müdürü"===e.role).map(e=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:T.includes(e.id),onChange:l=>{l.target.checked?E(l=>[...l,e.id]):E(l=>l.filter(l=>l!==e.id))},className:"w-5 h-5 rounded text-blue-600"}),s.jsx("span",{className:"text-slate-700",children:e.name})]},e.id))]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Başkan Yardımcıları"}),t.filter(e=>"Bşk. Yrd."===e.role).map(e=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:T.includes(e.id),onChange:l=>{l.target.checked?E(l=>[...l,e.id]):E(l=>l.filter(l=>l!==e.id))},className:"w-5 h-5 rounded text-blue-600"}),s.jsx("span",{className:"text-slate-700",children:e.name})]},e.id))]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Müdürler"}),t.filter(e=>e.role.includes("Md.")).map(e=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:T.includes(e.id),onChange:l=>{l.target.checked?E(l=>[...l,e.id]):E(l=>l.filter(l=>l!==e.id))},className:"w-5 h-5 rounded text-blue-600"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-700 block",children:e.name}),s.jsx("span",{className:"text-xs text-slate-400",children:e.role})]})]},e.id))]})]}),s.jsxs("div",{className:"p-4 border-t flex gap-2 flex-shrink-0",children:[s.jsx("button",{type:"button",onClick:()=>I(!1),className:"flex-1 py-3 border rounded-xl hover:bg-slate-50",children:"İptal"}),s.jsx("button",{type:"button",onClick:()=>I(!1),className:"flex-1 py-3 bg-blue-900 text-white rounded-xl",children:"Tamam"})]})]})]})]})}export{b as default};
